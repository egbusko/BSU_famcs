---
output: html_document
---
#Лабораторный практикум ВКИАД c R

**Преподаватель**
```
Дернакова Оксана Владимировна
```
**Студент**
```
Бусько Егор Андреевич, 2 курс, 5 группа, ПМ
```
**Вариант № 3**


### Часть 1. Управление данными в R

Загрузка данных из текстового файла в таблицу данных

```{r}
qc <- read.table("QC3.txt")
```

Размерность таблицы данных

```{r}
dim(qc)
```

Первые три записи из таблицы

```{r}
head(qc, 3)

```

Таблица после переименования переменных

```{r}
names(qc) <- c('c1','kit','nbug','maker','vendor','c2','c3','c4','bug')
head(qc)
```

Комплексная статистика по переменной vendor
 
```{r}
summary(qc$vendor)
```

Комплексная статистика по переменной vendor после ее преобразования в переменную-фактор  

```{r}
vendor <- as.factor(qc[,5])
summary(vendor)
```

Число изделий, у которых количество некритических дефектов больше 3

```{r}
sum(qc $ nbug > 3)
```

Наблюдения, для которых количество некритических дефектов равно максимальному 

```{r}
for(k in 1:100){
  if(qc[k,3]==max(qc$nbug)){
    print(qc[k,])
  }
}
```


### Часть 2. Описательная статистика и графический анализ

Присоединение таблицы данных к списку текущих переменных и загрузка дополнительной библиотеки

```{r}
attach(qc)
library("e1071")
```

Выборочные среднее и медиана для переменной с1 в указанном порядке

```{r}
mean(c1)
median(c1)
```

Выборочные квартили Q1,Q2,Q3, а также интерквартильный размах для переменной c1 
 
```{r}
quantile(c1, probs = c(25,50,75)/100)
IQR(c1)
```

Комплексная статистика по переменной c1

```{r}
summary(c1)
```

Дисперсия для переменной с1 и переменной 2 * с1 + 100 

```{r}
var(c1)
var(2 * c1 + 100)
```
**Вывод:** Вторая дисперсия больше в 4 раза

Дисперсия для переменной с1, полученная с помощью векторного выражения

```{r}
sum((c1-mean(c1))^2)/(length(c1)-1)
```

Гистограмма для переменной с1

```{r}
hist(c1)
```

Асимметрия и эксцесс для переменной c1 в указанном порядке

```{r}
skewness(c1)
kurtosis(c1)
```
**Вывод:** Распределение переменной c1 скошено влево и имеет более тяжелые хвосты, чем у нормального распределения.

Проверка распределения переменной c1 на нормальность с помощью статистического теста Лиллиефорса

```{r}
library(nortest)

lillie.test(c1)
```
**Вывод:** Гипотеза о нормальном распределении принимается на уровне значимости 0.05.


### Часть 3. Анализ статистических зависимостей

Перекодирование переменной kit в переменную с двумя значениями (1 и 2)

```{r}
kit = data.frame(kit = ifelse(kit < 3, kit<-1, kit<-2))
```

Ранговый коэффициент корреляции Спирмена для переменных kit и maker 

```{r}
cor(kit, maker, method = "spearman")
```

Таблица сопряженности для переменных kit и maker

```{r}
dat<-data.frame(kit, maker)
with(dat,table(kit, maker, dnn = c("kit", "maker")))

```
Вывод: Согласно ранговому коэффициенту корреляции и таблице сопряженности согласованность между переменными практически отсутствует.

Тест на равенство нулю коэффициента корреляции для переменных с1 и с3

```{r}
cor.test(c1,c3)
```
Вывод: Гипотеза о равенстве нулю коэффициента корреляции между переменными отклоняется на уровне значимости 0.05.

Корреляционная матрица для числовых характеристик с1-c4.   

```{r}
d <- data.frame(qc[1],qc[6],qc[7],qc[8])
cor(d)
```

Матрица корреляции в удобном представлении

```{r}
symnum(cor(d))
```
Вывод: Наибольший коэффициент корреляции наблюдается между переменными c1 и c3.

Построение регрессионной модели по переменным c1 (зависимая - отклик) и c3 (независимая - фактор) и вывод общей статистики по результатам оценивания

```{r}
linmod<-lm(c1 ~ c3)
summary(linmod)
```

Вывод: Коэффициент при зависимой переменной является статистически значимым (на уровне 0.05). Коэффициент при независимой переменной является статистически значимым (на уровне 0.05). Статистика R-квадрат принимает значение 0.7634.

Диаграмма рассеяния с линией регрессии для переменных c1 и c3


```{r}
plot(c3,c1)
abline(linmod)
```

Коэффициенты регрессионной модели

```{r}
coefficients(linmod)
```

График “Квантиль-квантиль” для остатков модели

```{r}
res <- residuals(linmod)
qqnorm(res)
```

Вывод: Большинство точек располагаются вблизи прямой линии, поэтому распределение остатков близко к нормальному.

Тест Колмогорова-Смирнова на нормальность остатков

```{r}
ks.test(res,"pnorm")
```
Вывод: Критерий принимает гипотезу о нормальном распределении остатков на уровне значимости 0.05.

### Часть 4. Анализ неоднородных данных

Частоты значений для переменной maker

```{r}
table(maker)
```

Двухвыборочный t-критерий по переменной, для которой наблюдается значимое различие средних в двух подвыборках (по значениям переменной maker), c разбиением на подвыборки по переменной maker  

```{r}
t.test(c2~maker)

```

Вывод: Гипотеза о равенстве средних в двух подвыборках отклоняется на уровне значимости 0.05 для переменной c2 (средние значения характеристики c2 у двух производителей статистически различимы).

“Ящики с усами” для переменной c2 в разрезе по номеру производителя

```{r}
boxplot(c2~maker)
```

График ядерной оценки плотности распределения для переменной c2

```{r}
plot(density.default(c2))
```

Вывод: Из графика видно, что выборка описывается моделью, которая представляет собой смесь двух распределений.

### Часть 5. Классификация неоднородных данных

Диаграмма рассеяния переменных c1 и c2, для которых коэффициент корреляции принимает наиболее близкое к нулю значение


```{r}
plot(c1,c2)
```

Первые 3 строки матрицы из переменных c1 и c2

```{r}
binded<-cbind(c1,c2)
head(binded,3)
```

Применение кластерного анализа и вывод частот наблюдений в каждом оцененном классе

```{r}
kmres<-kmeans(binded,2)
table(kmres[1])
```

График с классовой принадлежностью наблюдений

```{r}
plot(c1~c2, pch =ifelse(kmres$cluster == 1,1,2), col = ifelse(kmres$cluster == "1","1","2"))
legend("topleft", legend=c("1", "2"), pch = c(2,1), col = c ("red","black"))

```

Работа с данными закончена

```{r}
detach(qc)
```